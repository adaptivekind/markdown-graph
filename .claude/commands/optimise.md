Analyse this code for performance issues and suggest optimisations.
